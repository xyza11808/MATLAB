%x:datapoints at which to set weights
%
%mode==1:mean waveforms
%mode==2:assignment
function [weights,weightsInv] = setDistanceWeight(x,mode)

weights=[];

%sum 1
%weights=[0.00376040483222247	0.00391872719227713	0.00402013991507288	0.00402673633425588	0.00393927544758201	0.00379512195653398	0.00368482247208692	0.00365478909249634	0.00369512335303773	0.00376167086060582	0.00381331941713165	0.00383198372691427	0.00382408306380195	0.00380857836305327	0.00380269845662633	0.00381376496556887	0.00383838047359155	0.00386786745318895	0.00389443226891499	0.00391574912796249	0.00393423964179127	0.00395475591274941	0.00397883819197753	0.0040067542265076	0.00403681341036563	0.00406677794394769	0.00409434008759311	0.00411902785605723	0.00414260846818579	0.00416549369535032	0.00418736289928643	0.00420736033158508	0.00422473819832005	0.00423786885976246	0.00424595024999532	0.00424998863401915	0.00425149395357902	0.00425240204392767	0.00425323759079114	0.00425344771865179	0.00425266563515843	0.00425158254566158	0.00425015248994059	0.00425087505165089	0.00425676915311794	0.00426948970792795	0.00428856974134651	0.00431258800236893	0.00433944609095936	0.00436916941196126	0.0044033769775934	0.00444459240459113	0.00449426692956342	0.00455157896003739	0.00461371524936321	0.00467748172915825	0.00474120423541287	0.00480516745532531	0.00487104777495817	0.00494047998569186	0.00501378534802627	0.00508926458991951	0.00516378305714217	0.00523408523197194	0.00529781743232895	0.00535342339718837	0.00539942204394822	0.00543337541888994	0.0054513344116424	0.00544803387693609	0.00541780451365476	0.00535573865617427	0.00525846918856806	0.00512426990752799	0.00495273079494621	0.00474449107981981	0.00450138145773353	0.00422709485550315	0.00392836938244627	0.00361635246470037	0.00330757882492635	0.00302485685694054	0.00279519499248157	0.00264356680717646	0.00258301936889933	0.00261114495290428	0.00270863019004328	0.00285187884473382	0.0030169034547935	0.00318205129897507	0.00332935351339674	0.00344522638071219	0.00352172847132938	0.00355308878565128	0.00355414710968269	0.003534523716361	0.00347446376009314	0.00338212272102481	0.00326462430931054	0.00312950392886772	0.00298799070698563	0.00285506119893882	0.00274783797957953	0.00268219773127536	0.00267237849463496	0.00272857938898321	0.00285001368247295	0.00302307670174915	0.00323046952661814	0.0034577623176203	0.00369344661820205	0.00392804725256225	0.00415400602802727	0.00436556443354728	0.00455851239595292	0.00473014328151653	0.00487929059057818	0.00500607001690174	0.00511136638982426	0.00519642612062486	0.00526268162115117	0.00531165606340463	0.00534489735198813	0.00536402838203326	0.0053708529533047	0.00536731785644719	0.00535529894720923	0.00533639516135476	0.00531185766529498	0.0052826100176584	0.00524930964875696	0.00521246789769527	0.0051725853218413	0.00513018532775981	0.00508572856642742	0.00503953244331005	0.00499178365684639	0.00494260051469825	0.00489208829757348	0.00484039561677047	0.00478775946377161	0.00473447472288978	0.00468078816074807	0.00462682095842349	0.00457259218287635	0.00451810036724397	0.00446339988265383	0.0044086628175782	0.00435420487413946	0.00430041678942419	0.00424761570527177	0.00419593977052816	0.00414537369673208	0.00409585779057095	0.0040473924243021	0.00400010504130864	0.00395425256266379	0.00391011522867302	0.00386782548869882	0.0038272815151326	0.00378823111846887	0.00375044585931077	0.00371386318144255	0.00367864899838476	0.00364515188717487	0.00361371838174088	0.00358445633833274	0.00355714817184096	0.00353140689456998	0.00350694438245775	0.00348377145032725	0.00346225136336523	0.00344296888083017	0.0034264129486902	0.00341265181135527	0.00340129288896397	0.0033917876545296	0.0033838025894468	0.00337736488249746	0.00337272712529975	0.00337003787621789	0.00336897224358665	0.00336859535064385	0.00336767551478894	0.00336528666280663	0.00336124788460053	0.00335610848363848	0.00335074233732286	0.00334579294468646	0.0033408314221173	0.00333581105917166	0.00333006337213527	0.00332328431813494	0.00331583917756865	0.00330863109365236	0.00330271471960454	0.00329883696201958	0.00329703772501209	0.00329659320544699	0.00329649675288612	0.00329615588826495	0.00329572237474036	0.0032958825003312	0.00329740007840676	0.0033006509464626	0.00330526908183092	0.00331017336572003	0.00331416915429363	0.00331671982965083	0.00331821853964709	0.00331964179343696	0.00332199208519458	0.00332577587405446	0.0033303464434587	0.00333465203189027	0.00333723365723705	0.00333739592856547	0.00333556690941989	0.00333293063959527	0.00333087555014026	0.00333047358455754	0.00333188007467665	0.00333410341149008	0.00333573505427525	0.00333609750178508	0.003335500088039	0.00333521283408678	0.00333655878755704	0.00334046365731351	0.00334663682454961	0.00335311823791202	0.00335722543139889	0.00335764489901267	0.00335504083125097	0.00335120292049311	0.00334782144767086	0.00334584801794083	0.00334463133306225	0.00334175322181907	0.00333552352463637	0.00332830694240112	0.00332572792529758	0.00333058405367046	0.0033392445999196	0.00334233243671829	0.00333023244521073	0.0032987900911998	0.00325667411876137	0.003231081679679	0.00325679484170784	0.00334255591829604	0.00344567320263679	0.0034947245526788	0.00344473072398254	0.00331322133856145	0.00318291763005641];

%sum 256
%weights=[0.962663637048953	1.00319416122295	1.02915581825866	1.03084450156951	1.00845451458099	0.971551220872699	0.943314552854251	0.935626007679064	0.945951578377659	0.962987740315089	0.976209770785703	0.980987834090053	0.978965264333299	0.974996060941638	0.973490804896339	0.97632383118563	0.982625401239437	0.99017406801637	0.996974660842238	1.0024317767584	1.00716534829856	1.01241751366385	1.01858257714625	1.02572908198594	1.0334242330536	1.04109515365061	1.04815106242384	1.05447113115065	1.06050776785556	1.06636638600968	1.07196490221733	1.07708424488578	1.08153297876993	1.08489442809919	1.0869632639988	1.0879970903089	1.08838245211623	1.08861492324548	1.08882882324253	1.08888261597486	1.08868240260056	1.08840513168937	1.08803903742479	1.08822401322263	1.08973290319819	1.09298936522956	1.09787385378471	1.10402252860645	1.1108981992856	1.11850736946208	1.12726450626391	1.13781565557533	1.15053233396824	1.16520421376957	1.18111110383698	1.19743532266451	1.21374828426569	1.23012286856328	1.24698823038929	1.26476287633712	1.28352904909473	1.3028517350194	1.3219284626284	1.33992581938482	1.35624126267621	1.37047638968022	1.38225204325074	1.39094410723583	1.39554160938045	1.39469667249564	1.38695795549562	1.37106909598061	1.34616811227342	1.31181309632717	1.26789908350623	1.21458971643387	1.15235365317978	1.08213628300881	1.00566256190625	0.925786230963295	0.846740179181146	0.774363355376778	0.715569918075283	0.676753102637173	0.661252958438228	0.668453107943496	0.693409328651081	0.730080984251859	0.772327284427136	0.814605132537618	0.852314499429565	0.881977953462321	0.901562488660322	0.909590729126728	0.909861660078768	0.904838071388416	0.889462722583845	0.865823416582351	0.835743823183497	0.801153005790137	0.764925620988321	0.730895666928337	0.70344652277236	0.686642619206493	0.684128894626549	0.698516323579701	0.729603502713075	0.773907635647782	0.827000198814244	0.885187153310797	0.945522334259725	1.00558009665594	1.06342554317498	1.1175844949881	1.16697917336395	1.21091668006823	1.24909839118801	1.28155392432685	1.30850979579501	1.33028508687996	1.3472464950147	1.35978395223159	1.36829372210896	1.37319126580052	1.374938356046	1.37403337125048	1.37095653048556	1.36611716130682	1.35983556231552	1.35234816452055	1.34382327008178	1.33439178180999	1.32418184239137	1.31332744390651	1.30194651300542	1.29012030548737	1.27789661615268	1.26530573176275	1.25237460417881	1.23914127789324	1.22566642272553	1.21202552905978	1.19828176915151	1.18446616535641	1.17058359881634	1.15663369401446	1.14263036995938	1.12861768130002	1.1146764477797	1.10090669809259	1.08738962054957	1.07416058125521	1.06121566636341	1.04853959438616	1.03613246062134	1.02402689057501	1.01228865604193	1.00098949854029	0.990163325106897	0.979784067873945	0.969787166328032	0.960114139983556	0.950748974449292	0.941734143586498	0.933158883116767	0.925111905725666	0.917620822613182	0.910629931991287	0.904040165009916	0.897777761909183	0.891845491283775	0.886336349021498	0.881400033492523	0.877161714864692	0.87363886370695	0.870730979574777	0.868297639559577	0.866253462898381	0.864605409919351	0.863418144076737	0.86272969631178	0.862456894358183	0.862360409764826	0.862124931785968	0.861513385678498	0.860479458457735	0.859163771811451	0.857790038354651	0.856522993839733	0.855252844062029	0.853967631147945	0.85249622326663	0.850760785442544	0.848854829457576	0.847009559975004	0.845494968218762	0.844502262277012	0.844041657603095	0.843927860594429	0.843903168738846	0.843815907395828	0.843704927933533	0.843745920084788	0.84413442007213	0.844966642294426	0.846148884948716	0.847404381624327	0.84842730349917	0.849080276390612	0.849463946149656	0.849828299119863	0.850429973809813	0.851398623757941	0.852568689525428	0.85367092016391	0.854331816252684	0.854373357712761	0.853905128811493	0.85323024373639	0.852704140835907	0.85260123764673	0.852961299117223	0.853530473341461	0.853948173894464	0.854040960456981	0.853888022537984	0.853814485526215	0.854159049614603	0.85515869627226	0.856739027084701	0.858398268905477	0.859449710438116	0.859557094147243	0.858890452800248	0.857907947646237	0.857042290603741	0.856537092592853	0.856225621263936	0.855488824785683	0.853894022306912	0.852046577254688	0.85138634887618	0.852629517739638	0.854846617579418	0.855637103799882	0.852539505973947	0.844490263347148	0.833708574402909	0.827156909997823	0.833739479477207	0.855694315083787	0.882092339875018	0.894649485485773	0.88185106533953	0.848184662671732	0.81482691329444];

%max 1
%weights=[0.689813639792742	0.718856503080772	0.737459787182948	0.738669843049069	0.722625902232104	0.696182195028936	0.675948711606694	0.670439348701635	0.677838318842826	0.690045881715131	0.699520361287606	0.702944166978697	0.701494858879849	0.698650656052086	0.697572038234329	0.699602093282668	0.704117594656077	0.709526725223158	0.714399810181827	0.71831020302105	0.721702127352327	0.725465659252759	0.729883344430299	0.735004298754885	0.740518395228921	0.746015128931052	0.751071165043341	0.755599921967772	0.759925580668547	0.764123677031093	0.76813539274778	0.771803748197769	0.774991567073429	0.77740027298851	0.778882733909565	0.779623540420206	0.779899678232748	0.780066259528278	0.780219533350864	0.780258079483752	0.780114613052543	0.779915929681637	0.779653598367318	0.779786146043858	0.780867367818559	0.783200843230166	0.786700909815296	0.791106851408445	0.796033734729541	0.801486220076691	0.807761301194277	0.815321913676553	0.824434274287967	0.834947669017809	0.846346032176949	0.858043439633526	0.869732780525643	0.881466278249767	0.893551451284127	0.906288187923399	0.919735420618912	0.9335814326581	0.94725119892001	0.960147522924574	0.971838642115664	0.982039073910981	0.990477126557616	0.996705578598498	1	0.9993945455448	0.993849231132101	0.982463788083891	0.964620548197807	0.94000285445415	0.908535492588507	0.870335723614206	0.825739372752467	0.775423875386429	0.720625279208053	0.66338848282302	0.606746637642036	0.554883745616552	0.51275426921377	0.48493939420238	0.473832491982657	0.478991886340281	0.496874707275061	0.523152430099146	0.553424762999369	0.583719702130027	0.610741015316589	0.631996887469283	0.646030532232261	0.6517833098008	0.651977450161946	0.648377708916981	0.637360231042282	0.62042106861058	0.598867004441754	0.574080343004466	0.548120970271826	0.523736205366757	0.504067036084042	0.492025902051982	0.490224648285669	0.50053421473388	0.522810282265234	0.554557191591983	0.5926016058965	0.634296496328599	0.677530736385199	0.720566187275748	0.762016364131976	0.800824918064787	0.83621954767943	0.867703744502333	0.895063524291868	0.918320110065215	0.937635816087145	0.953239285692483	0.965393282406537	0.974377218917361	0.980475044894155	0.983984466367963	0.985236374755177	0.984587891908487	0.982383127289334	0.978915391790647	0.974414201034973	0.969048973839568	0.962940310091052	0.956182010511594	0.948865898007326	0.941087986971279	0.932932779828337	0.924458501857295	0.915699401266862	0.906677180571118	0.897411152602464	0.88792857881418	0.878272933237484	0.868498309841049	0.858649975820841	0.848750160794025	0.838802362429036	0.828806311642645	0.818771982346443	0.808730942677564	0.798741105451207	0.788874147995728	0.779188247229917	0.769708745360934	0.760432837853208	0.751349574486466	0.742459023548087	0.733784563420953	0.725373324046806	0.717276713078213	0.709519027201544	0.702081587025497	0.69491813057338	0.687986752619863	0.681275977769931	0.674816241419399	0.668671487001408	0.66290528315839	0.657537415183597	0.652527968976545	0.64780595500213	0.643318519401043	0.639067646058727	0.635119972821867	0.631582768702839	0.62854572659722	0.626021365349901	0.623937669591475	0.622194016805457	0.620729225897428	0.619548284413525	0.618697528094521	0.618204208683384	0.618008727623011	0.617939589882717	0.617770853975973	0.617332639806393	0.616591760986433	0.61564898247131	0.614664609488401	0.613756686352034	0.612846538084748	0.611925596060916	0.610871232743173	0.609627674104418	0.608261927664358	0.606939667209945	0.605854359723546	0.605143018739459	0.604812964321289	0.604731421063889	0.604713727678455	0.604651199021172	0.604571674726411	0.604601048376741	0.604879434907627	0.605475778446725	0.606322935311374	0.607222583639429	0.607955576384302	0.608423475647966	0.608698400993412	0.608959484552482	0.609390625183407	0.610084728420184	0.610923159721424	0.6117129825623	0.612186559333019	0.612216326600292	0.611880808907289	0.611397208081225	0.611020219751428	0.610946482652881	0.611204491061998	0.611612342909921	0.611911653622116	0.611978141473065	0.611868551104732	0.611815856859519	0.612062760345643	0.612779074822358	0.613911488791113	0.61510044783728	0.615853876846901	0.61593082454119	0.615453130904172	0.614749099474792	0.614128797624473	0.613766789062713	0.61354359877815	0.613015634242159	0.611872850345175	0.610549030947884	0.610075932636756	0.610966747253175	0.612555449320442	0.613121886189935	0.610902247731924	0.605134420694239	0.597408610964335	0.592713900064246	0.597430756541428	0.613162881946364	0.632078853074556	0.641076897651908	0.631905963542731	0.607781707811836	0.583878623050286];

%inverse
%weights=[0.789526421249312	0.761224157670393	0.743095261601447	0.741916062438866	0.757550879066381	0.783320265639788	0.803037790570327	0.808406663451231	0.801196368754329	0.789300101549482	0.780067223390263	0.776730725533586	0.778143075941804	0.780914750941783	0.781965863756533	0.779987575579916	0.77558722053249	0.770316024041839	0.765567203873011	0.761756526952653	0.758451097473766	0.754783536504403	0.750478503317301	0.745488134508529	0.740114648765748	0.734758083040186	0.729830977014331	0.72541770443549	0.72120235102878	0.717111307091269	0.71320189105018	0.709627079509834	0.706520550750392	0.704173267391426	0.702728609565611	0.702006693791769	0.701737597557105	0.701575264123013	0.701425898818237	0.701388335620624	0.701528143624764	0.701721760523909	0.701977402329238	0.701848234649006	0.700794584278814	0.69852061302814	0.695109798947804	0.690816209880984	0.686014963220373	0.680701517506539	0.674586452404049	0.667218637283023	0.658338643967877	0.648093343227303	0.636985640956392	0.625586520086567	0.614195260081949	0.602760969254718	0.590983970918735	0.578572023999971	0.565467698838191	0.551974763297931	0.538653579226997	0.526086114457545	0.514693121500987	0.504752803067962	0.496529922709044	0.490460297631053	0.487249884734754	0.487839899961771	0.493243807578582	0.50433891920437	0.521727152359948	0.545717089238013	0.576382026121896	0.61360769218114	0.657066825815086	0.706099266399034	0.759500485742114	0.815277730624502	0.870475195695698	0.921015572018554	0.962070737060937	0.989176326347359	1	0.994972171387892	0.977545366509485	0.95193773167523	0.922437350242659	0.89291493904374	0.866582675572673	0.845868833059999	0.832193049473659	0.826586969059309	0.826397779322127	0.829905726335495	0.840642255984525	0.857149465869225	0.878153896432877	0.902308492289433	0.927605895032964	0.951368842811521	0.970536443743184	0.982270526081578	0.984025847461607	0.973979177334494	0.952271154660502	0.921333798840216	0.884259525870862	0.843627864756725	0.801496107788379	0.759558070816523	0.719164883025658	0.681345956164689	0.646853897764761	0.616172555218909	0.589510456121271	0.566846918646497	0.548023767580985	0.532818190047659	0.520974123051679	0.512219278992953	0.506276948984303	0.502857018567105	0.501637034132368	0.502268980516972	0.504417523130071	0.507796830574124	0.512183239927866	0.517411652592939	0.523364544007635	0.529950505389823	0.537080055338645	0.544659627850227	0.552606875331	0.560865057260201	0.569400798766338	0.578192950754444	0.587222692873795	0.596463458844456	0.605872883233025	0.615398251479502	0.624995450711853	0.634642818173276	0.644336945386687	0.654078094573631	0.663856546159561	0.673641537002118	0.68337663107624	0.69299197884197	0.702430886905358	0.711668659291367	0.720708029019267	0.729559667076187	0.738223506916095	0.746676766310259	0.754873517141319	0.762763662663696	0.770323525762128	0.777571309499129	0.784552096160321	0.79130672237813	0.79784637092235	0.804141382506777	0.810129444270556	0.815748608586291	0.82097959469027	0.825861298864212	0.830462900393711	0.83483590535248	0.838978380444611	0.842825387103872	0.846272391702431	0.849231988534226	0.851691977987796	0.853722539024027	0.855421728262037	0.856849166664231	0.857999993868052	0.858829055704796	0.859309795357224	0.859500291605494	0.859567666317471	0.859732099419694	0.860159139026929	0.860881125266185	0.861799862711833	0.86275913395675	0.863643904843835	0.864530844120489	0.865428301910407	0.866455778720485	0.867667626327273	0.868998545918266	0.870287088426271	0.87134472032157	0.872037921946576	0.872359559900996	0.872439023786534	0.87245626598656	0.872517200148668	0.872594696555579	0.872566071940104	0.872294784329933	0.871713647688557	0.870888093519253	0.870011386430959	0.869297085170058	0.868841117445482	0.868573202759723	0.868318776891598	0.867898630446152	0.867222227001925	0.866405175892151	0.865635493715795	0.865173993261904	0.865144985066808	0.865471946981292	0.865943215874806	0.866310590915287	0.866382447700822	0.866131018565616	0.865733567033838	0.865441888813804	0.865377096418381	0.865483892207059	0.865535242736871	0.865294635346561	0.864596587054135	0.863493049902639	0.862334409586241	0.861600193190054	0.861525207679707	0.861990720018859	0.862676798484489	0.863281282494626	0.863634059754607	0.863851558635462	0.864366059954073	0.865479702598238	0.866769764295717	0.867230798490848	0.866362699852507	0.8648145100542	0.86426251745546	0.866425554621097	0.872046300739661	0.879575100540418	0.884150095230281	0.879553519680646	0.864222567100271	0.845788957596555	0.83702036523025	0.845957438405463	0.869466520053843	0.892760070643584];



if mode==1
    weights=repmat(1,1,length(x));
else
    r=70; %radius
    c=95; %center of realigned spikes
    weights = exp( -(x-c).^2/(2*r^2));
end

weights=weights';
weightsInv=1./weights;
