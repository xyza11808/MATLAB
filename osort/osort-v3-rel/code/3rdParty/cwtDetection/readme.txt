this code is from Zoran Nenadic, available for free on his website
robotics.caltech.edu/~zoran/Research/detection.html

it is slightly modified by me

see Nenadic&Burdick05, IEEE T on Biomed Engi for details of this.

